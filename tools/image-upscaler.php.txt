<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Image Upscaler Tool</title>
  <link rel="stylesheet" href="assets/style.css">
  <script src="style.js"></script>
</head>
<body>
  <?php include('common-header.php'); ?>
  <h1>Image Upscaler Tool</h1>

  <form method="POST" enctype="multipart/form-data">
    <input type="file" name="image" id="image" accept="image/*" required>
    <br><br>
    <label for="scale">Upscale Factor (2x, 4x, 8x, etc.):</label>
    <input type="number" name="scale" id="scale" value="2" min="2" max="10" required>
    <br><br>
    <button type="submit" name="upscale">Upscale Image</button>
  </form>

  <?php
    if (isset($_POST['upscale'])) {
      $file = $_FILES['image']['tmp_name'];
      $scale = $_POST['scale'];

      list($original_width, $original_height) = getimagesize($file);

      // Calculate new dimensions based on upscale factor
      $new_width = $original_width * $scale;
      $new_height = $original_height * $scale;

      // Create image from the uploaded file
      $image = imagecreatefromstring(file_get_contents($file));

      // Create a new true color image with the new dimensions
      $upscaled_image = imagecreatetruecolor($new_width, $new_height);

      // Resample the image to new dimensions
      imagecopyresampled($upscaled_image, $image, 0, 0, 0, 0, $new_width, $new_height, $original_width, $original_height);

      // Output the upscaled image
      $upscaled_image_name = 'upscaled_' . $_FILES['image']['name'];

      header('Content-Type: image/jpeg');
      imagejpeg($upscaled_image, $upscaled_image_name, 100); // Save at 100% quality

      // Display the upscaled image
      echo "<br><br><strong>Upscaled Image:</strong><br>";
      echo "<img src='" . $upscaled_image_name . "' alt='Upscaled Image'>";
      imagedestroy($image);
      imagedestroy($upscaled_image);
    }
  ?>

  <?php include('ads.php'); ?>
</body>
</html>
